<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Demographics Survey</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      padding: 20px;
      line-height: 1.6;
      background-color: #f2f2f2;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    .question {
      margin-bottom: 20px;
    }
    .question label {
      margin-top: 10px;
      display: block;
    }
    button {
      background-color: #007BFF;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 20px;
      width: 100%;
    }
    button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <h1>Please Fill Out the Demographics Questions</h1>
  <form id="surveyForm">
    <!-- Age -->
    <div class="question">
      <label for="age">What is your age?</label>
      <label><input type="radio" name="age" value="15 or younger" required> 15 or younger</label>
      <label><input type="radio" name="age" value="16–19"> 16–19</label>
      <label><input type="radio" name="age" value="20–24"> 20–24</label>
      <label><input type="radio" name="age" value="25–29"> 25–29</label>
      <label><input type="radio" name="age" value="30–34"> 30–34</label>
      <label><input type="radio" name="age" value="35–39"> 35–39</label>
      <label><input type="radio" name="age" value="40–44"> 40–44</label>
      <label><input type="radio" name="age" value="45–49"> 45–49</label>
      <label><input type="radio" name="age" value="50–54"> 50–54</label>
      <label><input type="radio" name="age" value="55–59"> 55–59</label>
      <label><input type="radio" name="age" value="60–64"> 60–64</label>
      <label><input type="radio" name="age" value="65 or older"> 65 or older</label>
    </div>
    
    <!-- Gender -->
    <div class="question">
      <label for="gender">What is your gender?</label>
      <label><input type="radio" name="gender" value="Female" required> Female</label>
      <label><input type="radio" name="gender" value="Male"> Male</label>
      <label><input type="radio" name="gender" value="Non-binary"> Non-binary</label>
      <label><input type="radio" name="gender" value="Prefer not to disclose"> Prefer not to disclose</label>
      <label><input type="radio" name="gender" value="Other"> Other</label>
    </div>
    
    <!-- Ethnicity -->
    <div class="question">
      <label for="ethnicity">How would you describe your ethnicity?</label>
      <label><input type="radio" name="ethnicity" value="White" required> White</label>
      <label><input type="radio" name="ethnicity" value="Black or African-American"> Black or African-American</label>
      <label><input type="radio" name="ethnicity" value="American Indian or Alaskan Native"> American Indian or Alaskan Native</label>
      <label><input type="radio" name="ethnicity" value="Asian"> Asian</label>
      <label><input type="radio" name="ethnicity" value="South Asian"> South Asian</label>
      <label><input type="radio" name="ethnicity" value="Native Hawaiian or other Pacific islander"> Native Hawaiian or other Pacific islander</label>
      <label><input type="radio" name="ethnicity" value="From multiple races"> From multiple races</label>
      <label>
        <input type="radio" name="ethnicity" value="Some other race" id="someOtherRace">
        Some other race (please specify):
      </label>
      <input type="text" id="otherEthnicity" name="otherEthnicity" placeholder="" disabled>
      <label><input type="radio" name="ethnicity" value="Prefer not to disclose"> Prefer not to disclose</label>
    </div>
    
    <!-- Education -->
    <div class="question">
      <label for="education">What is the highest level of school you have completed?</label>
      <label><input type="radio" name="education" value="Less than high school degree" required> Less than high school degree</label>
      <label><input type="radio" name="education" value="High school degree or equivalent"> High school degree or equivalent (e.g., GED)</label>
      <label><input type="radio" name="education" value="Some college but no degree"> Some college but no degree</label>
      <label><input type="radio" name="education" value="Associate degree"> Associate degree</label>
      <label><input type="radio" name="education" value="Bachelor degree"> Bachelor degree</label>
      <label><input type="radio" name="education" value="Graduate degree"> Graduate degree (e.g., Masters, PhD, M.D)</label>
    </div>
    
    <!-- Employment -->
    <div class="question">
      <label for="employment">Which of the following categories best describes your employment status?</label>
      <label><input type="radio" name="employment" value="Employed part time" required> Employed part time</label>
      <label><input type="radio" name="employment" value="Employed full time"> Employed full time</label>
      <label><input type="radio" name="employment" value="Not employed, looking for work"> Not employed, looking for work</label>
      <label><input type="radio" name="employment" value="Not employed, not looking for work"> Not employed, not looking for work</label>
      <label><input type="radio" name="employment" value="Retired"> Retired</label>
      <label><input type="radio" name="employment" value="Disabled, not able to work"> Disabled, not able to work</label>
      <label><input type="radio" name="employment" value="Prefer not to disclose"> Prefer not to disclose</label>
    </div>
    
    <!-- Income -->
    <div class="question">
      <label for="income">What was your combined household income in the last year?</label>
      <label><input type="radio" name="income" value="$0 – $9,999" required> $0 – $9,999</label>
      <label><input type="radio" name="income" value="$10,000 – $19,999"> $10,000 – $19,999</label>
      <label><input type="radio" name="income" value="$20,000 – $29,999"> $20,000 – $29,999</label>
      <label><input type="radio" name="income" value="$30,000 – $39,999"> $30,000 – $39,999</label>
      <label><input type="radio" name="income" value="$40,000 – $49,999"> $40,000 – $49,999</label>
      <label><input type="radio" name="income" value="$50,000 – $59,999"> $50,000 – $59,999</label>
      <label><input type="radio" name="income" value="$60,000 – $69,999"> $60,000 – $69,999</label>
      <label><input type="radio" name="income" value="$70,000 – $79,999"> $70,000 – $79,999</label>
      <label><input type="radio" name="income" value="$80,000 – $89,999"> $80,000 – $89,999</label>
      <label><input type="radio" name="income" value="$90,000 – $99,999"> $90,000 – $99,999</label>
      <label><input type="radio" name="income" value="$100,000 or more"> $100,000 or more</label>
      <label><input type="radio" name="income" value="Prefer not to disclose"> Prefer not to disclose</label>
    </div>
    
    <!-- Living Situation -->
    <div class="question">
      <label for="living">Which of the following describes your current living situation?</label>
      <label><input type="radio" name="living" value="Own my home" required> Own my home</label>
      <label><input type="radio" name="living" value="Rent my home"> Rent my home</label>
      <label><input type="radio" name="living" value="Other"> Other</label>
      <label><input type="radio" name="living" value="Prefer not to disclose"> Prefer not to disclose</label>
    </div>
    
    <!-- Language -->
    <div class="question">
      <label for="language">What language do you mainly speak at home? (Select all that apply)</label>
      <label><input type="checkbox" name="language" value="English"> English</label>
      <label><input type="checkbox" name="language" value="Spanish"> Spanish</label>
      <label><input type="checkbox" name="language" value="Chinese"> Chinese</label>
      <label><input type="checkbox" name="language" value="French"> French</label>
      <label>
        <input type="checkbox" name="language" value="Other" id="otherLangCheckbox"> Other (please specify):
        <input type="text" id="other-language" name="other-language" placeholder="" disabled>
      </label>
    </div>
    
    <!-- Religion -->
    <div class="question">
      <label for="religion">Do you identify with any of the following religions? (Select all that apply)</label>
      <label><input type="checkbox" name="religion" value="Protestantism"> Protestantism</label>
      <label><input type="checkbox" name="religion" value="Catholicism"> Catholicism</label>
      <label><input type="checkbox" name="religion" value="Christianity"> Christianity</label>
      <label><input type="checkbox" name="religion" value="Judaism"> Judaism</label>
      <label><input type="checkbox" name="religion" value="Islam"> Islam</label>
      <label><input type="checkbox" name="religion" value="Buddhism"> Buddhism</label>
      <label><input type="checkbox" name="religion" value="Hinduism"> Hinduism</label>
      <label><input type="checkbox" name="religion" value="Inter/Non-denominational"> Inter/Non-denominational</label>
      <label><input type="checkbox" name="religion" value="No religion"> No religion</label>
      <label>
        <input type="checkbox" name="religion" value="Other" id="religionOtherCheckbox"> Other (please specify):
        <input type="text" id="religion-other-text" name="religion-other-text" placeholder="" disabled>
      </label>
    </div>
    
    <!-- Political Viewpoints -->
    <div class="question">
      <label for="politics">How would you describe your political viewpoints?</label>
      <label><input type="radio" name="politics" value="Very liberal" required> Very liberal</label>
      <label><input type="radio" name="politics" value="Slightly liberal"> Slightly liberal</label>
      <label><input type="radio" name="politics" value="Moderate"> Moderate</label>
      <label><input type="radio" name="politics" value="Slightly conservative"> Slightly conservative</label>
      <label><input type="radio" name="politics" value="Very conservative"> Very conservative</label>
      <label><input type="radio" name="politics" value="Prefer not to disclose"> Prefer not to disclose</label>
    </div>
    
    <button type="submit">Submit</button>
  </form>
  
  <script>
    // Enable/disable "Other" text for ethnicity.
    const ethnicityRadios = document.querySelectorAll('input[name="ethnicity"]');
    ethnicityRadios.forEach(radio => {
      radio.addEventListener("change", () => {
        const otherEthnicity = document.getElementById("otherEthnicity");
        if (document.getElementById("someOtherRace").checked) {
          otherEthnicity.disabled = false;
          otherEthnicity.required = true;
        } else {
          otherEthnicity.disabled = true;
          otherEthnicity.required = false;
          otherEthnicity.value = "";
        }
      });
    });
    
    // Enable/disable "Other" text for language.
    const otherLangCheckbox = document.getElementById("otherLangCheckbox");
    const otherLangText = document.getElementById("other-language");
    otherLangCheckbox.addEventListener("change", () => {
      if (otherLangCheckbox.checked) {
        otherLangText.disabled = false;
        otherLangText.required = true;
      } else {
        otherLangText.disabled = true;
        otherLangText.required = false;
        otherLangText.value = "";
      }
    });
    
    // Enable/disable "Other" text for religion.
    const religionOtherCheckbox = document.getElementById("religionOtherCheckbox");
    const religionOtherText = document.getElementById("religion-other-text");
    religionOtherCheckbox.addEventListener("change", () => {
      if (religionOtherCheckbox.checked) {
        religionOtherText.disabled = false;
        religionOtherText.required = true;
      } else {
        religionOtherText.disabled = true;
        religionOtherText.required = false;
        religionOtherText.value = "";
      }
    });
    
    // Handle form submission and custom validation.
    document.getElementById("surveyForm").addEventListener("submit", function(event) {
      event.preventDefault();
      
      // First, check HTML5 form validity.
      if (!this.checkValidity()) {
        this.reportValidity();
        return;
      }
      
      // Custom check: ensure every required group is answered.
      const requiredGroups = ["age", "gender", "ethnicity", "education", "employment", "income", "living", "language", "religion", "politics"];
      for (let group of requiredGroups) {
        if (!document.querySelector('input[name="' + group + '"]:checked')) {
          alert("Please answer all required questions.");
          return;
        }
      }
      
      // Collect form data.
      const formData = new FormData(this);
      const dataObj = {};
      formData.forEach((value, key) => {
        dataObj[key] = value;
      });
      
      // Retrieve participant SID from localStorage (or default to "unknown").
      const participantSID = localStorage.getItem("participantSID") || "unknown";
      dataObj.participantSID = participantSID;
      
      // Store the demographics data in localStorage.
      localStorage.setItem("demographicsData", JSON.stringify(dataObj));
      
      // Redirect to Pretestsurvey.html.
      window.location.href = "Pretestsurvey.html";
    });
  </script>
</body>
</html>
